<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>المركز الطبي عصفور</title>
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/3063/3063176.png">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        :root {
            --primary-color: #0d47a1;
            --accent-color: #1976d2;
            --bg-color: #f4f6f8;
            --text-color: #2c3e50;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Cairo', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            padding-bottom: 80px;
        }

        header {
            background: linear-gradient(135deg, #000000, #0d47a1);
            color: white;
            padding: 20px;
            border-bottom: 5px solid #ffca28;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-img {
            width: 55px;
            height: 55px;
            background: white;
            border-radius: 8px;
            padding: 3px;
        }

        header div h1 {
            font-size: 1.1rem;
            font-weight: 700;
            margin: 0;
            color: #ffca28;
        }

        header div p {
            font-size: 0.8rem;
            opacity: 0.9;
            margin: 0;
            color: #fff;
        }

        .section {
            display: none;
            padding: 15px;
            animation: fadeIn 0.3s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* شريط التخصصات */
        .filter-scroll {
            display: flex;
            overflow-x: auto;
            gap: 8px;
            padding-bottom: 10px;
            margin-bottom: 15px;
            scrollbar-width: none;
        }

        .filter-scroll::-webkit-scrollbar {
            display: none;
        }

        .filter-btn {
            background: white;
            border: 1px solid #ccc;
            padding: 8px 15px;
            border-radius: 4px;
            font-size: 0.9rem;
            white-space: nowrap;
            cursor: pointer;
            font-weight: 700;
            color: #333;
            transition: 0.2s;
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Grid System للأطباء */
        .doctors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 12px;
        }

        .doctor-cell {
            background: white;
            border: 1px solid #999;
            border-top: 4px solid var(--primary-color);
            padding: 10px;
            position: relative;
        }

        .doc-name {
            font-weight: 800;
            font-size: 1rem;
            color: #000;
            margin-bottom: 5px;
            border-bottom: 1px dashed #eee;
            padding-bottom: 5px;
        }

        .doc-spec {
            font-size: 0.85rem;
            color: #fff;
            background-color: #555;
            padding: 2px 8px;
            border-radius: 2px;
            display: inline-block;
            margin-bottom: 8px;
        }

        .time-row {
            font-size: 0.9rem;
            color: #c62828;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 4px;
            line-height: 1.4;
        }

        .time-row i {
            color: #555;
            font-size: 0.8rem;
        }

        /* Form */
        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 700;
        }

        input,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #aaa;
            border-radius: 4px;
            background: white;
            font-size: 1rem;
        }

        button.btn-primary {
            width: 100%;
            padding: 14px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1.1rem;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: #fff;
            display: flex;
            justify-content: space-around;
            padding: 8px 0;
            border-top: 2px solid #0d47a1;
            z-index: 1000;
        }

        .nav-item {
            text-align: center;
            color: #666;
            text-decoration: none;
            flex: 1;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .nav-item i {
            display: block;
            font-size: 1.5rem;
            margin-bottom: 2px;
        }

        .nav-item.active {
            color: var(--primary-color);
        }
    </style>
</head>

<body>

    <header>
        <img src="https://cdn-icons-png.flaticon.com/512/3063/3063176.png" alt="شعار" class="logo-img">
        <div>
            <h1>المركز الطبي عصفور</h1>
            <p>جدول العيادات الرسمي (20/11/2025)</p>
        </div>
    </header>

    <!-- الرئيسية -->
    <div id="home" class="section active">
        <div
            style="background: #e1f5fe; padding: 20px; border-radius: 8px; text-align: center; border: 1px solid #b3e5fc;">
            <h2 style="color: #0277bd;">مرحباً بك</h2>
            <p>يمكنك الحجز الآن حسب الجدول الجديد</p>
        </div>
        <br>
        <button class="btn-primary" onclick="switchTab('booking')"><i class="fas fa-calendar-check"></i> حجز
            كشف</button>
        <button class="btn-primary" onclick="switchTab('doctors')" style="background: #37474f; margin-top: 15px;"><i
                class="fas fa-table"></i> عرض الجدول</button>
    </div>

    <!-- الجدول -->
    <div id="doctors" class="section">
        <h2 style="margin-bottom: 15px;">جدول العيادات</h2>
        <div class="filter-scroll">
            <button class="filter-btn active" onclick="filterDoctors('الكل', this)">الكل</button>
            <button class="filter-btn" onclick="filterDoctors('باطنة', this)">باطنة</button>
            <button class="filter-btn" onclick="filterDoctors('غدد', this)">غدد وسكر</button>
            <button class="filter-btn" onclick="filterDoctors('أسنان', this)">أسنان</button>
            <button class="filter-btn" onclick="filterDoctors('أطفال', this)">أطفال</button>
            <button class="filter-btn" onclick="filterDoctors('عظام', this)">عظام</button>
            <button class="filter-btn" onclick="filterDoctors('نساء', this)">نساء وتوليد</button>
            <button class="filter-btn" onclick="filterDoctors('رمد', this)">رمد</button>
            <button class="filter-btn" onclick="filterDoctors('جلدية', this)">جلدية</button>
            <button class="filter-btn" onclick="filterDoctors('أنف', this)">أنف وأذن</button>
            <button class="filter-btn" onclick="filterDoctors('سمعيات', this)">سمعيات</button>
            <button class="filter-btn" onclick="filterDoctors('مسالك', this)">مسالك</button>
            <button class="filter-btn" onclick="filterDoctors('مخ', this)">مخ وأعصاب</button>
            <button class="filter-btn" onclick="filterDoctors('صدر', this)">صدر</button>
            <button class="filter-btn" onclick="filterDoctors('قلب', this)">قلب</button>
            <button class="filter-btn" onclick="filterDoctors('جراحة', this)">جراحة</button>
            <button class="filter-btn" onclick="filterDoctors('تغذية', this)">تغذية</button>
            <button class="filter-btn" onclick="filterDoctors('روماتيزم', this)">روماتيزم</button>
            <button class="filter-btn" onclick="filterDoctors('سونار', this)">سونار / رسم عصب</button>
        </div>

        <div id="doctorsList" class="doctors-grid"></div>
    </div>

    <!-- الحجز -->
    <div id="booking" class="section">
        <h2 style="margin-bottom: 15px;">حجز موعد</h2>
        <form id="bookingForm">
            <div class="form-group">
                <label>اسم المريض</label>
                <input type="text" id="pName" placeholder="الاسم ثلاثي" required>
            </div>
            <div class="form-group">
                <label>الموبايل</label>
                <input type="tel" id="pPhone" placeholder="01xxxxxxxxx" required>
            </div>
            <div class="form-group">
                <label>نوع الحجز</label>
                <select id="pType" required>
                    <option value="">اختر..</option>
                    <option value="نقدي">نقدي</option>
                    <option value="كريستال عصفور">كريستال عصفور</option>
                    <option value="Medright">Medright</option>
                    <option value="AXA">AXA</option>
                    <option value="MetLife">MetLife</option>
                    <option value="شركات أخرى">شركات أخرى</option>
                </select>
            </div>
            <div class="form-group">
                <label>العيادة</label>
                <select id="pSpecialty" onchange="updateDoctorsInForm()" required>
                    <option value="">اختر التخصص</option>
                    <option value="باطنة">باطنة</option>
                    <option value="غدد">غدد صماء وسكر</option>
                    <option value="أسنان">أسنان</option>
                    <option value="أطفال">أطفال</option>
                    <option value="عظام">عظام</option>
                    <option value="نساء">نساء وتوليد</option>
                    <option value="رمد">رمد</option>
                    <option value="جلدية">جلدية</option>
                    <option value="أنف">أنف وأذن</option>
                    <option value="سمعيات">سمعيات</option>
                    <option value="مسالك">مسالك بولية</option>
                    <option value="مخ">مخ وأعصاب / نفسية</option>
                    <option value="صدر">أمراض صدر</option>
                    <option value="قلب">قلب</option>
                    <option value="جراحة">جراحة عامة / أورام</option>
                    <option value="تغذية">تغذية علاجية</option>
                    <option value="روماتيزم">روماتيزم</option>
                    <option value="سونار">سونار / رسم عصب</option>
                </select>
            </div>
            <div class="form-group">
                <label>الدكتور</label>
                <select id="pDoctor" required>
                    <option value="">اختر التخصص أولاً</option>
                </select>
            </div>
            <button type="submit" class="btn-primary" id="submitBtn">تأكيد وحجز دور</button>
        </form>
    </div>

    <nav class="bottom-nav">
        <a href="#" class="nav-item active" onclick="switchTab('home', this)"><i
                class="fas fa-clinic-medical"></i>الرئيسية</a>
        <a href="#" class="nav-item" onclick="switchTab('booking', this)"><i class="fas fa-file-signature"></i>حجز</a>
        <a href="#" class="nav-item" onclick="switchTab('doctors', this)"><i class="fas fa-calendar-alt"></i>الجدول</a>
    </nav>

    <!-- الجزء 1: كود العمليات (يعمل بدون Firebase) -->
    <script>
        // === قاعدة البيانات المطابقة للصور بنسبة 100% ===
        const doctorsData = [
            // --- باطنة ---
            { n: "د. سهام", s: "باطنة", t: "السبت: 1 - 10", c: "باطنة" },
            { n: "د. منار فاروق", s: "باطنة", t: "السبت: 3 - 12 / الاثنين: 3 - 7", c: "باطنة" },
            { n: "د. هناء عمر", s: "باطنة", t: "السبت: 5 - 3 / الأحد: 4 - 2.30 / الخميس: 2 - 7", c: "باطنة" },
            { n: "د. منى رمضان", s: "باطنة", t: "الأحد: 1 - 10 / الثلاثاء: 2 - 7", c: "باطنة" },
            { n: "د. أميمة فؤاد", s: "باطنة", t: "الأحد: 6 - 5 / الاثنين: 1 - 10 / الثلاثاء: 2 - 12.30", c: "باطنة" },
            { n: "د. أمل جمال", s: "باطنة", t: "الاثنين: 1 - 10 / الخميس: 1 - 11", c: "باطنة" },
            { n: "د. أحمد صبحي", s: "باطنة/كلى", t: "الثلاثاء: 4 - 2.30 / الخميس: 12 - 9", c: "باطنة" },
            { n: "د. محمد شعلان", s: "باطنة/", t: "الأربعاء: 4 - 2 / الجمعة: 3 - 5", c: "باطنة" },
            { n: "د. محمد كمال", s: "باطنة", t: "الاثنين: 6 - 3", c: "باطنة" },
            { n: "د. إنجي يسري", s: "باطنة", t: "الأربعاء: 7 - 5", c: "باطنة" },
            

            // --- غدد ---
            { n: "د. بهاء محمود", s: "غدد صماء وسكر", t: "السبت: 3 - 1.30", c: "غدد" },
            { n: "د. محمد كرم ", s: "غدد", t: "الاثنين: 3 - 6 / الأربعاء: 1 - 3", c: "غدد" },
            { n: "د. أحمد سلام", s: "غدد ", t: "الاثنين: أجازة", c: "غدد" },
            { n: "د. مؤمن نصحي ", s: "غدد/كلى", t: "الثلاثاء: 4 - 1", c: "غدد" },

            // --- أسنان ---
            { n: "د. أحمد عبدالمنعم", s: "أسنان 1", t: "السبت: 4 - 11 / الاثنين: 3 - 11 / الأربعاء: 7 - 5", c: "أسنان" },
            { n: "د. أحمد صفوت", s: "أسنان 1", t: "الأحد: 4 - 2", c: "أسنان" },
            { n: "د. محمد العدل", s: "أسنان 2", t: "السبت: 7 - 5 / الأحد: 6 - 5 / الاثنين: 6 - 2 / الجمعة: 3 - 7", c: "أسنان" },
            { n: "د. محمد حسن", s: "أسنان 2", t: "الأحد: 2 - 10 / الاثنين: 1 - 10 / الأربعاء: 1 - 10 / الخميس: 2 - 6", c: "أسنان" },
            { n: "د. أحمد حجاج", s: "أسنان 2", t: "السبت: 3 - 12", c: "أسنان" },
            { n: "د. أحمد عادل", s: "أسنان 2", t: "الأربعاء: 6 - 3 / الخميس: 3 - 1", c: "أسنان" },
            { n: "د. أحمد صالح", s: "أسنان 2", t: "الجمعة: 6 - 3", c: "أسنان" },
            { n: "د. طريف كمال", s: "أسنان 3", t: "السبت: 5 - 11 / الثلاثاء: 1.30 - 11.30 / الخميس: 6 - 11", c: "أسنان" },
            { n: "د. إسلام صبري", s: "اسنان 2", t: "الثلاثاء: 5 - 1.30 / الخميس: 5 - 1.30", c: "اسنان 2" },
            { n: "د. محمد صلاح", s: "أسنان 3", t: "الأحد: 5 - 10", c: "أسنان" },
            { n: "د. مريهان محمود", s: "أسنان 3", t: "الاثنين: 2 - 11 / الأربعاء: 1 - 11", c: "أسنان" },
            { n: "د. أحمد سليمان", s: "أسنان 3", t: "الاثنين: 4 - 12", c: "أسنان" },
            { n: "د. تميم طه", s: "أسنان 3", t: "الثلاثاء: 2 - 12.30", c: "أسنان" },

            // --- أطفال ---
            { n: "د. أحمد بدر", s: "أطفال", t: "السبت: 2 - 11 / الأحد: 1 - 12 / الاثنين: 1 - 10 / الأربعاء: 3 - 9 / الخميس: 1 - 10", c: "أطفال" },
            { n: "د. أحمد حازم", s: "أطفال", t: "الأحد: 12 - 10.30", c: "أطفال" },
            { n: "د. روضة عبدالفتاح", s: "أطفال", t: "السبت: 5 - 10 / الثلاثاء: 2 - 10.30", c: "أطفال" },
            { n: "د. أيمن ربيع", s: "أطفال", t: "السبت: 6 - 1", c: "أطفال" },
            { n: "د. أحمد صالح", s: "أطفال", t: "الجمعة: 5 - 6.30", c: "أطفال" },
            { n: "د. أحمد رمضان", s: "أطفال", t: "الجمعة: 5 - 6.30", c: "أطفال" },

            // --- عظام ---
            { n: "د. خالد حسني", s: "عظام", t: "السبت: 1 - 10", c: "عظام" },
            { n: "د. أحمد حجاج", s: "عظام", t: "السبت: 3 - 12", c: "عظام" },
            { n: "د. رمزي", s: "عظام", t: "السبت: 6 - 1 / الأحد: 6 - 1 / الثلاثاء: 6 - 1 / الأربعاء: 2 - 12 / الخميس: 1 - 10", c: "عظام" },
            { n: "د. محمد عرفة", s: "عظام", t: "الأحد: 7 - 3.30 / الثلاثاء: 3.30 - 7 / الخميس: 7 - 3.30", c: "عظام" },
            { n: "د. عماد عبدالحليم", s: "عظام", t: "الاثنين: 1.30 - 11.30", c: "عظام" },
            { n: "د. محمد عبدالفتاح", s: "عظام", t: "الخميس: 6 - 4", c: "عظام" },
            { n: "د. أحمد صالح", s: "عظام", t: "الجمعة: 6 - 3", c: "عظام" },

            // --- نساء وتوليد ---
            { n: "د. محمد مسلم", s: "نساء وتوليد", t: "السبت: 1 - 12 / الاثنين: 12 - 9", c: "نساء" },
            { n: "د. أمال طه", s: "نساء وتوليد", t: "السبت: 4 - 2 / الاثنين: 4 - 2", c: "نساء" },
            { n: "د. نهلة السيد", s: "نساء وتوليد", t: "الأحد: 5 - 3 / الخميس: 3 - 1", c: "نساء" },
            { n: "د. روضه عبدالفتاح", s: "نساء وتوليد", t: "الأحد: 3 - 10.30 / الأربعاء: 2 - 10.30", c: "نساء" },
            { n: "د. منال عبدالعظيم", s: "نساء وتوليد", t: "السبت: 6 - 4 / الثلاثاء: 3 - 6", c: "نساء" },
            { n: "د. مريهان محمود", s: "نساء وتوليد", t: "الاثنين: 1 - 11", c: "نساء" },
            { n: "د. مصطفى محمود", s: "نساء وتوليد", t: "الاثنين: 6 - 4", c: "نساء" },
            { n: "د. محمد عبدالمنعم", s: "نساء وتوليد", t: "الاثنين: 1 - 12", c: "نساء" },

            // --- رمد ---
            { n: "د. عبدالوهاب", s: "رمد", t: "السبت: 2 - 12 / الأحد: 2.30 - 1 / الخميس: 4.30 - 2.30 / الجمعة: 7 - 6", c: "رمد" },
            { n: "د. منال حامد", s: "رمد", t: "السبت: 4 - 2 / الاثنين: 4 - 12 / الثلاثاء: 4 - 2 / الأربعاء: 6 - 3", c: "رمد" },
            { n: "د. أحمد عصام", s: "رمد", t: "السبت: 6 - 2.30", c: "رمد" },
            { n: "د. تميم طه", s: "رمد", t: "الأحد: 4 - 2.30", c: "رمد" },
            { n: "د. أحمد صالح", s: "رمد", t: "الاثنين: 4 - 6", c: "رمد" },

            // --- جلدية ---
            { n: "د. سعيد حلمي", s: "جلدية", t: "السبت: 1 - 11.30 / الأربعاء: 1 - 11.30", c: "جلدية" },
            { n: "د. صباح أنور", s: "جلدية", t: "السبت: 4 - 2 / الاثنين: 4 - 3 / الثلاثاء: 5 - 2", c: "جلدية" },
            { n: "د. أمال عبدالمقصود", s: "جلدية", t: "الأحد: 4 - 2 / الأربعاء: 4 - 2", c: "جلدية" },
            { n: "د. محمد كمال", s: "جلدية", t: "الاثنين: 3 - 4", c: "جلدية" },

            // --- أنف وأذن ---
            { n: "د. محمد صلاح", s: "أنف وأذن", t: "السبت: 1 - 11 / الأحد: 6 - 5 / الاثنين: 6 - 5 / الأربعاء: 6 - 5", c: "أنف" },
            { n: "د. نادر الفقي", s: "أنف وأذن", t: "السبت: 4 - 1.30 / الأحد: 3 - 1.30 / الاثنين: 2.30 - 12 / الثلاثاء: 3 - 1.30 / الأربعاء: 3 - 1.30", c: "أنف" },
            { n: "د. حسن أحمد", s: "أنف وأذن", t: "الاثنين: 2.30 - 12 / الأربعاء: 1 - 11", c: "أنف" },
            { n: "د. أحمد عصام", s: "أنف وأذن", t: "الاثنين: 6.30 - 5 / الجمعة: 7 - 5.30", c: "أنف" },
            { n: "د. تامر محسن", s: "أنف وأذن", t: "الخميس: 5 - 11", c: "أنف" },
            { n: "د. إيهاب الجوهري", s: "أنف وأذن", t: "الخميس: 6 - 3.30", c: "أنف" },

            // --- سمعيات ---
            { n: "د. عبير", s: "سمعيات", t: "الاثنين: 12 - 8 / الخميس: 12 - 8", c: "سمعيات" },

            // --- مسالك ---
            { n: "د. محمد حسني", s: "مسالك", t: "السبت: 7 - 5 / الأربعاء: 7 - 5", c: "مسالك" },
            { n: "د. أحمد يوسف", s: "مسالك", t: "الأحد: 6 - 5 / الثلاثاء: 6 - 4.30", c: "مسالك" },
            { n: "د. محمد الأتربي", s: "مسالك", t: "الاثنين: 4.30 - 3", c: "مسالك" },
            { n: "د. صادق الأزهري", s: "مسالك", t: "الخميس: 4 - 2.30 / الجمعة: 6.30 - 4", c: "مسالك" },

            // --- مخ وأعصاب ---
            { n: "د. مدحت مصطفى", s: "جراحة مخ وأعصاب", t: "السبت: 3 - 12.30", c: "مخ" },
            { n: "د. أحمد حازم", s: "أعصاب", t: "الأحد: 1 - 11", c: "مخ" },
            { n: "د. أحمد نبيل", s: "أعصاب", t: "الاثنين: 3 - 1", c: "مخ" },
            { n: "د. محمد عوض", s: "أعصاب", t: "الثلاثاء: 3 - 1 / الخميس: 3 - 1", c: "مخ" },
            { n: "د. أحمد يسري", s: "أعصاب", t: "الأربعاء: 4.30 - 3", c: "مخ" },

            // --- صدر ---
            { n: "د. كامل علي", s: "صدر", t: "الثلاثاء: 12 - 10", c: "صدر" },

            // --- قلب ---
            { n: "د. محمود النجار", s: "قلب", t: "السبت: 4 - 11 / الخميس: 1 - 11", c: "قلب" },
            { n: "د. أحمد يحيى", s: "قلب", t: "السبت: 7 - 5 / الأحد: 4 - 1 / الأربعاء: 2 - 11", c: "قلب" },
            { n: "د. عزت الكفراوي", s: "قلب", t: "الأحد: 1 - 10", c: "قلب" },
            { n: "د. محمد مصطفى", s: "قلب", t: "الأحد: 4.30 - 2", c: "قلب" },
            { n: "د. سعيد إبراهيم", s: "قلب", t: "الاثنين: إجازة / الثلاثاء: إجازة", c: "قلب" },
            { n: "د. محمد فارس", s: "قلب", t: "الثلاثاء: 5 - 2 / الخميس: 5 - 2", c: "قلب" },
            { n: "د. درويش إبراهيم", s: "قلب", t: "الأربعاء: 7 - 6", c: "قلب" },
            { n: "د. محمد حامد", s: "قلب", t: "الأربعاء: 10 - 8", c: "قلب" },

            // --- جراحة ---
            { n: "د. عمر حسين", s: "جراحة", t: "السبت: 1 - 10 / الأحد: 1 - 10 / الاثنين: 1 - 10 / الثلاثاء: 1 - 10", c: "جراحة" },
            { n: "د. مبروك عقل", s: "جراحة", t: "السبت: 3 - 1", c: "جراحة" },
            { n: "د. مصطفى سعد", s: "جراحة", t: "السبت: 5 - 3 / الأحد: 4 - 2.30", c: "جراحة" },
            { n: "د. محمد الصادق", s: "جراحة", t: "الأحد: 6 - 5 / الاثنين: 2 - 12.30", c: "جراحة" },
            { n: "د. أحمد فرحات", s: "جراحة", t: "الأحد: 4 - 2 / الأربعاء: 4 - 2", c: "جراحة" },
            { n: "د. إيهاب الصياد", s: "جراحة", t: "الاثنين: 6 - 4", c: "جراحة" },
            { n: "د. شريف محمد", s: "جراحة", t: "الثلاثاء: 6 - 2", c: "جراحة" },
            { n: "د. أحمد ناصر", s: "جراحة", t: "الخميس: 3 - 1", c: "جراحة" },
            { n: "د. محمد عمر", s: "جراحة", t: "الخميس: 12 - 9", c: "جراحة" },
            { n: "د. أحمد الخولي", s: "جراحة", t: "الجمعة: 7 - 5.30", c: "جراحة" },
            { n: "د. محمد كمال", s: "جراحة أورام", t: "الاثنين: 4 - 3", c: "جراحة" },
            { n: "د. أمل جمال", s: "جراحة وجه وفكين", t: "الأحد: 1 - 10", c: "جراحة" },

            // --- تغذية ---
            { n: "د. أحمد إبراهيم", s: "تغذية", t: "السبت: 4 - 2.30 / الاثنين: 4 - 3 / الجمعة: 7 - 4.30", c: "تغذية" },

            // --- روماتيزم ---
            { n: "د. علا", s: "روماتيزم", t: "السبت: 5 - 4 / الثلاثاء: 4 - 2.30", c: "روماتيزم" },
            { n: "د. رولا", s: "روماتيزم", t: "الأحد: 4 - 2 / الأربعاء: 4 - 2 / الخميس: 4 - 2", c: "روماتيزم" },

            // --- سونار ---
            { n: "د. عزت الكفراوي", s: "رسم عصب", t: "الأحد: 1 - 10", c: "سونار" },
            { n: "د. محمود علاء", s: "رسم عصب", t: "الأربعاء: 2 - 12", c: "سونار" }
        ];

        // 1. تعريف الدوال في الذاكرة (Global Scope)
        window.filterDoctors = function (cat, btn) {
            const list = document.getElementById('doctorsList');
            list.innerHTML = '';
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            if (btn) btn.classList.add('active');

            const filtered = cat === 'الكل' ? doctorsData : doctorsData.filter(d => d.c === cat);

            if (filtered.length === 0) {
                list.innerHTML = '<p style="grid-column:1/-1;text-align:center;color:#777;padding:20px;">لا يوجد أطباء مسجلين</p>';
                return;
            }

            filtered.forEach(doc => {
                list.innerHTML += `
                <div class="doctor-cell">
                    <div class="doc-name">${doc.n}</div>
                    <div class="doc-spec">${doc.s}</div>
                    <div class="time-row"><i class="far fa-clock"></i> ${doc.t}</div>
                </div>`;
            });
        }

        window.updateDoctorsInForm = function () {
            const spec = document.getElementById('pSpecialty').value;
            const select = document.getElementById('pDoctor');
            select.innerHTML = '<option value="">اختر الدكتور</option>';
            doctorsData.filter(d => d.c === spec).forEach(doc => {
                const opt = document.createElement('option');
                opt.value = doc.n;
                opt.text = doc.n;
                select.appendChild(opt);
            });
        }

        window.switchTab = function (id, el) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if (el) {
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                el.classList.add('active');
            }
            window.scrollTo(0, 0);
        }

        // تشغيل الجدول عند فتح الموقع
        window.onload = function () {
            filterDoctors('الكل');
        }
    </script>

    <!-- الجزء 2: كود FIREBASE (معزول) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // استبدل المفاتيح هنا بمعلومات مشروعك الحقيقي
        const firebaseConfig = {
            apiKey: "AIzaSyC7DEhZdEKyhWtMPMeQ6S6IrDB3lyxJ9DU",
            authDomain: "osretna.firebaseapp.com",
            databaseURL: "https://osretna-default-rtdb.firebaseio.com",
            projectId: "osretna",
            storageBucket: "osretna.firebasestorage.app",
            messagingSenderId: "891601757154",
            appId: "1:891601757154:web:19a8fab19ee8dc3d208fbb",
            measurementId: "G-TCB8XP9C87"
        };

        // محاولة الاتصال بفايربيس
        let db;
        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            console.log("تم الاتصال بقاعدة البيانات");
        } catch (e) {
            console.error("خطأ في الاتصال: تأكد من مفاتيح API", e);
        }

        // دالة الحجز
        window.handleBooking = async function (e) {
            e.preventDefault(); // منع إعادة تحميل الصفحة

            // التحقق من أن قاعدة البيانات تعمل
            if (!db) {
                alert("تنبيه: لا يمكن إتمام الحجز لأن قاعدة البيانات غير متصلة.\n(يرجى التأكد من مفاتيح Firebase في الكود)");
                return;
            }

            const btn = document.getElementById('submitBtn');
            btn.innerText = 'جاري الحجز...';
            btn.disabled = true;

            const name = document.getElementById('pName').value;
            const phone = document.getElementById('pPhone').value;
            const type = document.getElementById('pType').value;
            const spec = document.getElementById('pSpecialty').value;
            const docName = document.getElementById('pDoctor').value;
            const today = new Date().toISOString().split('T')[0];

            try {
                // حساب الدور
                const q = query(collection(db, "bookings"), where("doctor", "==", docName), where("date", "==", today));
                const snap = await getDocs(q);
                const turn = snap.size + 1;

                // حفظ الحجز
                await addDoc(collection(db, "bookings"), {
                    patientName: name, phone: phone, type: type, specialty: spec, doctor: docName,
                    queueNumber: turn, date: today, createdAt: new Date().toISOString()
                });

                alert(`تم الحجز بنجاح!\n\nالاسم: ${name}\nالدكتور: ${docName}\nرقم الدور: ${turn}`);
                document.getElementById('bookingForm').reset();
                window.switchTab('home');

            } catch (err) {
                console.error(err);
                alert("حدث خطأ أثناء الحجز، تأكد من الاتصال بالإنترنت.");
            } finally {
                btn.innerText = 'تأكيد وحجز دور';
                btn.disabled = false;
            }
        }

        // ربط الزر بالدالة يدوياً بعد تحميل الموديول
        const form = document.getElementById('bookingForm');
        if (form) {
            form.addEventListener('submit', window.handleBooking);
        }
    </script>
</body>

</html>
